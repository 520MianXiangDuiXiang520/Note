# 异常

## 概念

异常是程序中产生的**阻止当前方法或作用域**继续执行的问题

### 抛出异常

创建一个代表错误信息的**对象**，然后从当前环境中“抛出”以把错误信息传递到更大的环境中。

```java
if(t == null)
    throw new NullPointerException();
```

异常也是一个对象，需要使用`new`在**堆空间**为其分配内存，所有的标准异常类都有两个构造器——默认构造器和接受一个`String`的构造器，以便把相关信息放入异常对象

```java
if(t == null)
    throw new NullPointerException("t = null");
```

创建异常对象后，这个对象的引用就会被传递给`throw`

### 异常说明

Java鼓励人们把可能抛出的异常告知使用此方法的人，它使得调用者能确切的知道该怎样处理所有潜在异常，所以如果在方法中要抛出异常，需要在方法声明时使用`throws`关键字说明要抛出的异常，内部代码必须与异常说明保持一致，当然可以只声明异常而不抛出，为这个可能存在的异常占个位，这样在日后抛出异常时可以不用修改代码，常用在定义抽象类或接口时，派生类或接口的实现就可以抛出这些异常。

```java
package Note.exceptions;

class TooBig extends Exception{}
class TooSmall extends Exception{}

interface TestInterface1 {
    void method () throws TooBig, TooSmall;
    void method2();
}

public class ExceptionDescription implements TestInterface1 {
    @Override
    public void method() throws TooBig, TooSmall {
        throw new TooBig();
    }

    @Override
    public void method2(){
//        throw new TooSmall();
    }
}
```

### 捕获异常

* 监控区域：一段可能产生异常的代码，后面跟着处理这些异常的代码

如果在方法内部或作用域中抛出异常，这个方法或作用域将会在抛出异常的过程中结束，如果想阻止这种行为，需要将可能产生异常的代码放置在`try块`中以捕捉异常，异常处理程序必须紧跟在try块之后，以关键字`catch`表示，catch看似是一个仅接受一个异常类型的方法，并且必须要给这个“参数”一个标识符（e）虽然可以不用，但必须给出。

```java
try{
    //...
    // 可能产生TooBig异常
    //...
}catch(TooBig e){
    //异常处理
}
```

try,catch的结合似乎与switch与case的类似，但不同的是异常处理机制负责搜寻参数与异常类型相匹配的**第一个**处理程序，然后进入catch子句执行，而switch需要与每一个case匹配，所以我们才在每个case后面加上break；

### 恢复理论和终止理论

异常处理理论上有两种不同的模型，终止理论和恢复理论，恢复理论认为异常处理机制的主要作用是修正错误，产生异常后重新调用出现异常的方法，并认为第二次能成功；终止理论假设错误非常关键，一旦抛出，便无法挽回，也不能回来继续执行。

Java支持终止模型，如果想实现恢复模型，可以在遇到错误时调用方法修复错误而不是抛出异常，或者将try块放在while循环中，这样就会不断进入try块，直到获得满意的结果。

## 自定义异常

要定义自己的异常类，必须从已有的异常类中继承

## 捕获所有异常

* 栈轨迹

* 重新抛出异常

* 异常链

## Java标准异常

## finally