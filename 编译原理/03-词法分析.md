# 词法分析

## 1. 对于词法分析器的要求

### 1.1 词法分析器的功能哈输出形式

词法分析的任务：

* 从左到右逐个字符的对源程序进行扫描，产生一个个单词符号

对词法分析器的要求：

* 功能：输入源程序，输出单词符号

  * 单词符号的种类：基本字（保留字），标识符，常数，运算符，界符
  
* 输出的单词符号的形式：`(单词种别，单词自身的值)`
  
* 单词种别通常用整数编码表示
    * 若一个种别只有一个单词符号，那这个种别编码就代表该单词符号，可以不用给出值，如界符，运算符
    * 若一个种别有多个单词符号，则对于每个单词符号，给出种别编码和自身的值，如标识符，常数
  
  
  

### 1.2 词法分析器作为一个独立的子程序

词法分析是作为一个独立的阶段，而不是作为“一遍”

作为独立阶段的优点：

* 结构简洁，清晰，有条理
* 有利于集中注意力处理和分析词法分析的一些枝叶细节

词法分析器在编译器中的地位：

![image-20200227085144302](image/03-词法分析/image-20200227085144302.png)

## 2. 词法分析器的设计

词法分析器的结构：

![image-20200227085541722](image/03-词法分析/image-20200227085541722.png)

### 2.1 输入和预处理

预处理的工作：

* 剔除无用的空格，回车换行等编辑性字符
* 区分标号区，连接续行，给出末句符等

### 2.2 单词符号的识别：超前搜索

* 标识符识别
* 常数识别
* 算符和界符的识别

避免超前搜索：

* 所有基本字都作为保留字
* 基本字作为特殊标识符处理，使用保留字表
* 基本字，标识符，常数之间如果没有确定的运算符或界符分割，则必须使用一个空白符做间隔



### 2.3 状态转换图

状态转换图是一张有限方向图

* 节点代表状态，用圆圈表示
* 节点之间用箭弧连接，箭弧上的标记代表在射出的节点状态下可能出现的输入字符或字符类
* 一张状态转换图只能包含有限个状态，必须有一个初态一个终态（两个圆圈）

> ![image-20200227091930153](image/03-词法分析/image-20200227091930153.png)
>
> 上图表示在状态1下，如果输入X，则读入X，并转换到状态2
>
> 如果输入Y，则读入Y，并转换到状态3

状态转换图可以用来识别一定的字符串

* 如果存在一条从初态到某一终态的道路，且这条路上所有弧上的标记符连接成的字等于$\alpha$,则称$\alpha$为该状态转换图所接受

> 整常数的状态转换图
>
> ***表示退掉最后一个字符**
>
> ![image-20200227092645344](image/03-词法分析/image-20200227092645344.png)
>
> 

### 2.4 状态转换图的实现

每个状态都是一个代码段，用分支实现

## 3. 正规表达式与有限自动机

讨论自动将状态转换图实现的方法

概念：

* 字母表 $\Epsilon$：一个又穷的字符集
* 字符：$\Epsilon$中的每一个元素称为一个字符
* 字：由$\Epsilon$中的字符构成的又穷序列
* 空字 $\epsilon$：不包含任何字符的序列
* ${\Epsilon}^*$: $\Epsilon$上所有字的全体，包括 $\epsilon$
* 连接（积）：U, V为${\Epsilon}^*$的子集，UV积的定义为$$UV = \{\alpha\beta \ | \ \alpha \in U \  \& \ \beta \in V\}$$
* V自身的n次积记为：$$V^n \  = \  VVV...V$$
* $$V^0 \  = \  \{\epsilon\}$$
* 闭包：$$V^* \ = \ V^0 \ \or \ V^1 \or \ V^3 \ ...$$
* 正规闭包：$V^+ \ = \ VV^*$

### 3.1 正规式与正规集

* 所有词法结构一般都可以用正规式描述

* 若两个正规式所表示的正规集相同，则称这两个正规式等价
  $$
  b{(ab)}^* = {(ba)}^*b
  $$
  ![image-20200227103611369](image/03-词法分析/image-20200227103611369.png)

  

### 3.2 确定有限自动机DFA

### 3.3 非确定有限自动机

### 3.4 正规文法与有限自动机的等价性

### 3.5 正规式与有限自动机的等价性

### 3.6 确定有限自动机的化简



## 4. 词法分析器的自动产生

### 4.1 语言LEX的一般描述

### 4.2 超前搜索

### 4.3 LEX的实现

