# 指令系统

## 分类

1. 数据传递与交换
2. 算术运算
3. 逻辑运算
4. 程序转移
5. 布尔处理操作（位操作指令）



## 汇编语言的指令格式

* 操作码：指明执行什么性值和类型的操作
* 操作数：指明操作数本身或者操作数所在的地址以及结果保存的地址

格式：



```
<标号> 操作符 目标操作数,源操作数<; 注释>
```

## 指令描述符号

$R_n$: 当前选中的寄存器区中的8个工作寄存器R0～R7（n=0～7）。它在片内数据存储器中的地址由PSW中RS1和RS0确定。

$R_i$ : 当前选中的寄存器区中的2个工作寄存器R0、R1（i=0，1）

direct: 8位的片内RAM单元（包括SFR）的地址

#data8: 8位常数

#data16: 指令中的16位常数

addr16: 16位目的地址

rel: 8位补码形式的8位地址偏移量，在`-128~127`之间

DPTR： 数据指针，用作16位地址寄存器

A: 累加器

B: 专用寄存器，用于乘除指令

C: 进位标志或进位位，或布尔处理机中的累加器

bit： 内部RAM或专用寄存器中的直接寻址地址

@：简址寄存器或基址寄存器前缀

`/`: 位操作数的前缀，表示对该位操作数取反，如/bit。

`*`: 片内RAM的直接地址或寄存器

`(*)`: 由`*`寻址的单元中的内容



## 指令系统的寻址方式

寻找指令中操作数或操作数所在地址的方法

1. 立即寻址

   指令中直接给出操作数的寻址方式。在这种寻址方式中，紧跟在操作码之后的操作数称为立即数。立即数可以为一个字节，也可以是两个字节，并要用符号“＃”来标识。由于立即数是一个常数，所以只能作为源操作数。立即数表示方法：#data8，#data16。

2. 直接寻址

   指令中直接给出操作数地址的寻址方式。指令操作码之后的字节存放的是操作数的地址，操作数本身存放在该地址的存储单元中。

3. 寄存器寻址

   操作数存放在寄存器中，指令中直接给出该寄存器名称的寻址方式。

   * 寻址范围
     * 4组通用工作寄存Rn（R0~R7）共32个工作寄存器
     * 特殊功能寄存器，例如A【写成Acc是直接寻址】、B 【只有乘除指令是寄存器寻址】以及数据指针寄存器DPTR等。

4. 寄存器间接寻址

   寄存器中的内容为地址，该地址的内容为操作数的寻址方式称为寄存器间接寻址 。

   * 寻址范围
     * 访问内部RAM低128个单元，其通用形式为@Ri
     * 对外部RAM的64K字节的间接寻址
     * 片外数据存储器的低256字节

5. 变址寻址

   此种寻址方式又称为基址寄存器加变址寄存器间接寻址。在89C51中以程序计数器PC或数据指针DPTR作为基址寄存器，以累加器A作为变址寄存器。基址寄存器的内容与变址寄存器的内容之和作为操作数地址。主要用于查表操作。

   * **只能访问程序存储器，访问范围位64k**

6. 相对寻址

   相对寻址是以程序计数器PC的当前值为基准，加上指令中给出的相对偏移量 rel 形成目标地址的寻址方式 。该类寻址方式**主要用于跳转指令**。

7. 位寻址

   位寻址对位地址中的内容作位操作的寻址。位寻址实际是一种直接寻址方式，由指令给出直接位地址。与直接寻址不同之处在与位寻址给出的是位地址，而不是字节地址。

![image-20200302090453128](image/01-指令系统/image-20200302090453128.png)

## MCS-51指令系统

MCS-51指令系统由111条指令组成。其中，单字节指令49条，双字节指令45条，三字节指令17条。

从指令执行时间看，单周期指令64条，双周期45条，只有乘、除指令为4个周期。

### 传输类指令（28条）

![image-20200302092226169](image/01-指令系统/image-20200302092226169.png)

#### 以累加器A为目的操作数的指令(4条)

![image-20200302091308644](image/01-指令系统/image-20200302091308644.png)

![image-20200302091314515](image/01-指令系统/image-20200302091314515.png)

| 指令格式    | 操作         | 注释 |
| ----------- | ------------ | ---- |
| MOV A $R_n$ | ($R_n$) -> A |      |
|             |              |      |
|             |              |      |
|             |              |      |



#### 以寄存器Rn为目的操作数的指令（3条）

![image-20200302091426039](image/01-指令系统/image-20200302091426039.png)

> 注意：
>
> 1、源操作数有寄存器寻址、直接寻址、和立即寻址
>
> 2、89C51指令系统中没有“**MOV Rn，Rn**”传送指令。
>
> 3、89C51指令系统中没有“**MOV Rn，@Ri**”传送指令

#### 以直接地址为目的操作数的指令（5条）

![image-20200302091816013](image/01-指令系统/image-20200302091816013.png)

![image-20200302091824201](image/01-指令系统/image-20200302091824201.png)

> 注意：
>
> 1、源操作数有寄存器、直接地址、寄存器间接寻址、和立即数寻址。
>
> 2、MOV direct,direct 指令在译成机器指令时，源地址在前，目的地址在后，
>
> 例如：
>
> MOV 0A0H，90H
>
> 机器码为：8590A0

#### 以间接地址为目的操作数的指令（3条）

![image-20200302091951355](image/01-指令系统/image-20200302091951355.png)

> 说明：
>
> 1、源操作数为累加器A、直接地址、和立即数。
>
> 2、源操作数不能为工作寄存器Rn，也不可以再使用间接寻址方式,即@Ri。

#### 16位数据传输指令（1条）

![image-20200302092339101](image/01-指令系统/image-20200302092339101.png)

> 这条指令的功能是把16位常数送入DPTR。
>
> DPTR由DPH和DPL组成。

#### 查表指令（2条）

![image-20200302092516612](image/01-指令系统/image-20200302092516612.png)

#### 累加器A与片外RAM传输指令（4条）

![image-20200302093116320](image/01-指令系统/image-20200302093116320.png)

#### 栈操作（2条）

![image-20200302093447939](image/01-指令系统/image-20200302093447939.png)

* 只能直接寻址

#### 交换指令（4条）

1. 目标交换指令

   ![image-20200302094102007](image/01-指令系统/image-20200302094102007.png)

   > 将第二操作数所指定的工作寄存器Rn(R0~R7),
   >
   > 直接寻址和间接寻址的单元内容与累加器A中内容互换。
   >
   > 注：目的操作数只能为寄存器A

2. 半字节交换指令

   ![image-20200302094244023](image/01-指令系统/image-20200302094244023.png)

   > 这条指令为低半字节交换指令。该指令将累加器A的低4位与R0或R1所指出的片内RAM单元的低4位数据相互交换，各自的高4位不变，
   >
   > 注：源操作数只能间接寻址

### 运算类指令

